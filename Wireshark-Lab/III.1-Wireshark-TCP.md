# Wireshark Lab: TCP

## 2. 跟踪包的初步观察

2. gaia.cs.umass.edu 的 IP 地址是什么? 在哪个端口号上发送和接收此连接的 TCP 报文段?

    IP: 128.119.245.12，端口号：80

3. 客户端计算机(源)将文件传输到 gaia.cs.umass.edu 所使用的 IP 地址和 TCP 端口号是多少?

    IP: 192.168.0.105, 端口号：51657

## 3. TCP 基础

4. 用于在客户端计算机和 gaia.cs.umass.edu 之间启动 TCP 连接的 TCP SYN 区段的序列号是什么? 将区段标识为 SYN 区段的区段有什么功能?

    SYN 报文段的序列号为 0, 功能是向服务器端请求建立 TCP 连接

5. gaia.cs.umass.edu 发送给客户端计算机以回复 SYN 的 SYNACK 区段的序列号是多少? SYNACK 区段中的 Acknowledgment 字段的值是多少? Gaia.cs.umass.edu 是如何确定此 Acknowledgment 的数值的? 在将区段标识为 SYNACK 区段的区段在连线中有什么功能?

    SYNACK 报文段的序列号是 0，Acknowledgment 字段的值是 1, 由SYN 报文段的序列号加 1 得到。
    
    SYNACK 报文段的功能是功能是同意客户端建立 TCP 连接

6. 包含 HTTP POST 命令的 TCP 区段的序列号是多少?

    包含 HTTP POST 命令的报文段序列号是 1，该报文段的 PSH 标志被设置，表明开始发送 HTTP 报文

7. 将包含 HTTP POST 的 TCP 区段视为 TCP 连接中的第一个区段。在这个 TCP 连线中前六个 TCP 区段的序列号是什么(包括包含HTTP POST 的 段)? 每区段发送的时间是什么时候? 收到的每个区段的 ACK 是什么时候? 鉴于发送每个 TCP 区段的时间与收到确认的时间之间的差异，六个区段中每个区段的 RTT 值是多少? 收到每个 ACK 后，EstimatedRTT 值是什么? 假设第一个 EstimatedRTT的值等于第一个区段的测量 RTT，然后使用课本第 242 页的 EstimatedRTT 公式计算所有后续区段。

    见下表：
    |  序列号   | 发送时间(s)  | ACK 时间(s) | RTT(ms) | EstimatedRTT(ms) |
    |  ----  | ----  | ----  | ----  | ----  |
    | 1    | 1585039631.916502 | 1585039632.209377 | 292.875 | 292.875 |
    | 707  | 1585039631.916688 | 1585039632.209378 | 292.69  | 292.852 |
    | 2115 | 1585039631.916689 | 1585039632.209379 | 292.69  | 292.832 |
    | 3523 | 1585039632.209485 | 1585039632.605393 | 395.908 | 305.716 |
    | 4931 | 1585039632.209486 | 1585039632.609290 | 399.804 | 317.477 |
    | 6339 | 1585039632.209486 | 1585039632.932154 | 722.668 | 368.126 |

    公式: EstimatedRTT = (1-α)·EstimatedRTT + α·EstimatedRTT (α = 0.125)

    往返时间图如下：
    ![Round Trip Time Graph](https://raw.githubusercontent.com/china-university-mooc/Computer-Network/master/resource/time-sequence-graph.png)
8. 前六个 TCP 区段的长度是多少?

    前六个报文段的长度分别是：706、1408、1408、1408、1408、1408

9. 对于整个跟踪包，收到的最小可用缓冲区空间量是多少? 缺少接收器缓冲区空间是否会限制发送方传送 TCP 区段?

    收到的最小可用缓冲区空间量是 28960，对应的 Acknowledgment 为 1
    
    由于最小可用缓冲区空间量也很大，所以并没有限制发送方传送 TCP 报文段

10. 在跟踪文件中是否有重传的区段? 为了回答这个问题，您检查了什么(在 跟踪包中)?

    没有重传的报文段，因为发送的 TCP 报文段的序列号一直是递增的

11. 接收器通常在 ACK 中确认多少数据? 您是否可以识别接收方每隔一个接收到的区段才发送确认的情况。

    ACK 通常确认 1048 字节数据，跟每个报文段发送的数据一致

    观察到有 ack=13379 的 ACK 报文段紧接着 ack=16195 的 ACK 报文段，可见后一个ACK 报文段确认了 2816 字节，即隔一个报文段确认

12. TCP 连接的吞吐量(每单位时间传输的􏰁节数)是多少? 解释你如何计算 这个值。

    发送第一个报文段的时间是 1585039631.916502，收到最后一个 ACK 报文段的时间是 1585039634.241800，ack = 149429
    
    故，吞吐量为： T = 149429 / (1585039634.241800 - 1585039631.916502) ≈ 514.098 Kbps

## 4. TCP 拥塞控制

14. 使用时序图(Stevens)绘图工具查看从客户端发送到 gaia.cs.umass.edu 服务器的区段的序列号与时间关系图。您能否确定TCP 的慢启动阶段的开始和结束位置，以及拥塞避免接管的位置? 评论测量数据与我们在文本中研究的 TCP 的理想化行为的不同之处。
		
    时序图如下：
			 
    ![Time Sequence Graph][https://github.com/china-university-mooc/Computer-Network/blob/master/resource/time-sequence-graph.png]

    观察图可知，1s 时刻开始发送数据，慢启动开始，接着每隔 RTT 窗口尺寸翻倍, 直到 2.9s,慢启动结束

    之后的一个 RTT 窗口尺寸没有明显增长，说明被拥塞避免接管

    不同之处，慢启动阶段窗口尺寸并没有严格的翻倍
